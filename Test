import pandas as pd

# Load the first Excel sheet that contains 'Unique_Global_Lead' and 'Application_Product_Name'
lead_data = pd.read_excel('path_to_lead_data_excel.xlsx', sheet_name='SheetName')

# Load the MasterSheet that contains 'ServiceName' and 'CI_Count'
master_data = pd.read_excel('path_to_mastersheet_excel.xlsx', sheet_name='SheetName')

# Ensure the columns are named consistently
lead_data['Application_Product_Name'] = lead_data['Application_Product_Name'].str.strip()
master_data['ServiceName'] = master_data['ServiceName'].str.strip()

# Rename columns to make them consistent
master_data.rename(columns={'ServiceName': 'Application_Product_Name'}, inplace=True)

# Merge datasets on the common column
merged_data = pd.merge(lead_data, master_data, on='Application_Product_Name', how='left')

# Group by 'Unique_Global_Lead' and calculate the total 'CI_Count'
ci_count_by_lead = merged_data.groupby('Unique_Global_Lead')['CI_Count'].sum().reset_index()

# Now ci_count_by_lead DataFrame will have the total CI_Count for each Unique_Global_Lead
print(ci_count_by_lead)
