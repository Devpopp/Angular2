import pandas as pd

# Assuming getportfolio_leadData() returns a dictionary with 'app_name_data' being a list of app names
app_name_data = getportfolio_leadData()

# Normalizing app names
normalized_app_names = {
    name.lower().replace('_', ' ').strip()
    for name in app_name_data['app_name_data'] if isinstance(name, str)
}

# Assuming abhi_json is a list of dictionaries that represent your rows
# And each row dictionary has an 'ApplicationName' key

# Filtering abhi_json based on normalized app names
filtered_abhi_json = [
    row for row in abhi_json
    if row['ApplicationName'].lower().replace('_', ' ').strip() in normalized_app_names
]

# Creating a DataFrame from filtered data
filtered_data_df = pd.DataFrame(filtered_abhi_json)

# Assuming you want to change the 'ApplicationName' to uppercase for the matching names
for ind, row in filtered_data_df.iterrows():
    app_name = row['ApplicationName'].lower().replace('_', ' ').strip()
    if app_name in normalized_app_names:
        filtered_data_df.at[ind, 'ApplicationName'] = app_name.upper()

# Now filtered_data_df will have the filtered and updated data
# You can convert it back to a list of dictionaries if needed
updated_abhi_json = filtered_data_df.to_dict(orient='records')

# Display the updated JSON data
print(updated_abhi_json)
