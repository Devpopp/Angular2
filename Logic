# ... previous code ...

# Get portfolio data
app_name_data = getportfolio_leadData()

# Ensure the 'app_name_data' key exists in the returned data
if 'app_name_data' in app_name_data:
    # Normalize and create a set of app names
    app_name_set = set(
        ''.join(char for char in name.lower().replace('_', ' ') if char.isalnum() or char.isspace()).strip()
        for name in app_name_data['app_name_data'] if isinstance(name, str)
    )

# Assuming 'currentmonthmaindata_json' is a dictionary that has an 'app_name_data' key
for app in set(currentmonthmaindata_json['app_name_data']) - app_name_set:
    # Normalize app names directly in the loop
    normalized_app = ''.join(char for char in app.lower().replace('_', ' ') if char.isalnum() or char.isspace()).strip()
    if normalized_app not in app_name_set:
        new_row = {'app_name_data': normalized_app.upper()}
        # Suppose filtered_data is a DataFrame you are using to append new rows
        filtered_data = filtered_data.append(new_row, ignore_index=True)

# Assuming you want to replace the 'app_name_data' in 'currentmonthmaindata_json' with the normalized names
currentmonthmaindata_json['app_name_data'] = [name.upper() for name in app_name_set]

# ... rest of your code ...
